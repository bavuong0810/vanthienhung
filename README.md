iptables -t nat -A PREROUTING -p tcp -i eth0 --dport 8596 -j DNAT --to-destination 127.0.0.1:3306
iptables -A FORWARD -p tcp -d 127.0.0.1 --dport 3306 -m state --state NEW,ESTABLISHED,RELATED -j ACCEPT


iptables -A PREROUTING -t nat -i eth0 -p tcp --dport 8596 -j DNAT --to 127.0.0.1:3306
iptables -A FORWARD -p tcp -d 127.0.0.1 --dport 3306 -j ACCEPT

iptables -t nat -I OUTPUT -p tcp -o lo --dport 8596 -j REDIRECT --to-ports 3306

iptables -t nat -I PREROUTING -s ! 127.0.0.1 -p tcp --dport 3306 -j REDIRECT --to-ports 3306

iptables -A PREROUTING -t nat -p tcp -i eth0 --dport 8596 -j REDIRECT --to-port 3306

CREATE USER 'db_qlbhgr_uychan'@'%' IDENTIFIED VIA mysql_native_password USING '***';GRANT USAGE ON *.* TO 'db_qlbhgr_uychan'@'%' REQUIRE NONE WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0 MAX_USER_CONNECTIONS 0;CREATE DATABASE IF NOT EXISTS `db_qlbhgr_uychan`;GRANT ALL PRIVILEGES ON `db\_qlbhgr\_uychan`.* TO 'db_qlbhgr_uychan'@'%';




============================================================================
IPtables Firewall Rules in Server: 103.74.117.226 - Created by VPSSIM 
============================================================================

# Generated by iptables-save v1.4.21 on Tue Sep  8 16:44:41 2020
*filter
:INPUT ACCEPT [55129:138435762]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [59651:256959509]
-A INPUT -p tcp -m tcp --dport 8596 -j ACCEPT
-A FORWARD -d 127.0.0.1/32 -p tcp -m tcp --dport 3306 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
COMMIT
# Completed on Tue Sep  8 16:44:41 2020
# Generated by iptables-save v1.4.21 on Tue Sep  8 16:44:41 2020
*raw
:PREROUTING ACCEPT [62048:154187372]
:OUTPUT ACCEPT [64378:277869292]
COMMIT
# Completed on Tue Sep  8 16:44:41 2020
# Generated by iptables-save v1.4.21 on Tue Sep  8 16:44:41 2020
*mangle
:PREROUTING ACCEPT [62048:154187372]
:INPUT ACCEPT [59434:153940182]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [64378:277869292]
:POSTROUTING ACCEPT [64378:277869292]
COMMIT
# Completed on Tue Sep  8 16:44:41 2020
# Generated by iptables-save v1.4.21 on Tue Sep  8 16:44:41 2020
*nat
:PREROUTING ACCEPT [3349:291711]
:INPUT ACCEPT [751:45437]
:OUTPUT ACCEPT [789:47520]
:POSTROUTING ACCEPT [789:47520]
-A PREROUTING -p tcp -m tcp --dport 8596 -j REDIRECT --to-ports 3306
COMMIT
# Completed on Tue Sep  8 16:44:41 2020




# ======================================================



============================================================================
IPtables Firewall Rules in Server: 103.74.117.226 - Created by VPSSIM 
============================================================================

# Generated by iptables-save v1.4.21 on Tue Sep  8 21:42:23 2020
*filter
:INPUT ACCEPT [639:2430853]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [649:2782420]
:DOCKER - [0:0]
:DOCKER-ISOLATION-STAGE-1 - [0:0]
:DOCKER-ISOLATION-STAGE-2 - [0:0]
:DOCKER-USER - [0:0]
-A INPUT -p tcp -m tcp --dport 8596 -j ACCEPT
-A FORWARD -j DOCKER-USER
-A FORWARD -j DOCKER-ISOLATION-STAGE-1
-A FORWARD -o br-5b49c15166ad -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -o br-5b49c15166ad -j DOCKER
-A FORWARD -i br-5b49c15166ad ! -o br-5b49c15166ad -j ACCEPT
-A FORWARD -i br-5b49c15166ad -o br-5b49c15166ad -j ACCEPT
-A FORWARD -o docker0 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -o docker0 -j DOCKER
-A FORWARD -i docker0 ! -o docker0 -j ACCEPT
-A FORWARD -i docker0 -o docker0 -j ACCEPT
-A FORWARD -o br-c796faca013a -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -o br-c796faca013a -j DOCKER
-A FORWARD -i br-c796faca013a ! -o br-c796faca013a -j ACCEPT
-A FORWARD -i br-c796faca013a -o br-c796faca013a -j ACCEPT
-A FORWARD -o br-905866e96444 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -o br-905866e96444 -j DOCKER
-A FORWARD -i br-905866e96444 ! -o br-905866e96444 -j ACCEPT
-A FORWARD -i br-905866e96444 -o br-905866e96444 -j ACCEPT
-A FORWARD -o br-37cb60e72d96 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -o br-37cb60e72d96 -j DOCKER
-A FORWARD -i br-37cb60e72d96 ! -o br-37cb60e72d96 -j ACCEPT
-A FORWARD -i br-37cb60e72d96 -o br-37cb60e72d96 -j ACCEPT
-A FORWARD -o br-47e4ff45cb98 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -o br-47e4ff45cb98 -j DOCKER
-A FORWARD -i br-47e4ff45cb98 ! -o br-47e4ff45cb98 -j ACCEPT
-A FORWARD -i br-47e4ff45cb98 -o br-47e4ff45cb98 -j ACCEPT
-A FORWARD -d 127.0.0.1/32 -p tcp -m tcp --dport 3306 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
-A DOCKER -d 172.21.0.2/32 ! -i br-c796faca013a -o br-c796faca013a -p tcp -m tcp --dport 6060 -j ACCEPT
-A DOCKER -d 172.21.0.3/32 ! -i br-c796faca013a -o br-c796faca013a -p tcp -m tcp --dport 27017 -j ACCEPT
-A DOCKER -d 172.21.0.4/32 ! -i br-c796faca013a -o br-c796faca013a -p tcp -m tcp --dport 8081 -j ACCEPT
-A DOCKER -d 172.18.0.4/32 ! -i br-5b49c15166ad -o br-5b49c15166ad -p tcp -m tcp --dport 3080 -j ACCEPT
-A DOCKER -d 172.18.0.4/32 ! -i br-5b49c15166ad -o br-5b49c15166ad -p tcp -m tcp --dport 3009 -j ACCEPT
-A DOCKER -d 172.18.0.5/32 ! -i br-5b49c15166ad -o br-5b49c15166ad -p tcp -m tcp --dport 8080 -j ACCEPT
-A DOCKER-ISOLATION-STAGE-1 -i br-5b49c15166ad ! -o br-5b49c15166ad -j DOCKER-ISOLATION-STAGE-2
-A DOCKER-ISOLATION-STAGE-1 -i docker0 ! -o docker0 -j DOCKER-ISOLATION-STAGE-2
-A DOCKER-ISOLATION-STAGE-1 -i br-c796faca013a ! -o br-c796faca013a -j DOCKER-ISOLATION-STAGE-2
-A DOCKER-ISOLATION-STAGE-1 -i br-905866e96444 ! -o br-905866e96444 -j DOCKER-ISOLATION-STAGE-2
-A DOCKER-ISOLATION-STAGE-1 -i br-37cb60e72d96 ! -o br-37cb60e72d96 -j DOCKER-ISOLATION-STAGE-2
-A DOCKER-ISOLATION-STAGE-1 -j RETURN
-A DOCKER-ISOLATION-STAGE-2 -o br-5b49c15166ad -j DROP
-A DOCKER-ISOLATION-STAGE-2 -o docker0 -j DROP
-A DOCKER-ISOLATION-STAGE-2 -o br-c796faca013a -j DROP
-A DOCKER-ISOLATION-STAGE-2 -o br-905866e96444 -j DROP
-A DOCKER-ISOLATION-STAGE-2 -o br-37cb60e72d96 -j DROP
-A DOCKER-ISOLATION-STAGE-2 -j RETURN
-A DOCKER-USER -j RETURN
COMMIT
# Completed on Tue Sep  8 21:42:23 2020
# Generated by iptables-save v1.4.21 on Tue Sep  8 21:42:23 2020
*raw
:PREROUTING ACCEPT [766697:1544644245]
:OUTPUT ACCEPT [798830:2785877003]
COMMIT
# Completed on Tue Sep  8 21:42:23 2020
# Generated by iptables-save v1.4.21 on Tue Sep  8 21:42:23 2020
*mangle
:PREROUTING ACCEPT [766697:1544644245]
:INPUT ACCEPT [717468:1538472995]
:FORWARD ACCEPT [7447:1685362]
:OUTPUT ACCEPT [798830:2785877003]
:POSTROUTING ACCEPT [806277:2787562365]
COMMIT
# Completed on Tue Sep  8 21:42:23 2020
# Generated by iptables-save v1.4.21 on Tue Sep  8 21:42:23 2020
*nat
:PREROUTING ACCEPT [37:3383]
:INPUT ACCEPT [16:1282]
:OUTPUT ACCEPT [10:600]
:POSTROUTING ACCEPT [10:600]
:DOCKER - [0:0]
-A PREROUTING -p tcp -m tcp --dport 8596 -j REDIRECT --to-ports 3306
-A PREROUTING -m addrtype --dst-type LOCAL -j DOCKER
-A OUTPUT ! -d 127.0.0.0/8 -m addrtype --dst-type LOCAL -j DOCKER
-A POSTROUTING -s 172.18.0.0/16 ! -o br-5b49c15166ad -j MASQUERADE
-A POSTROUTING -s 172.17.0.0/16 ! -o docker0 -j MASQUERADE
-A POSTROUTING -s 172.21.0.0/16 ! -o br-c796faca013a -j MASQUERADE
-A POSTROUTING -s 172.20.0.0/16 ! -o br-905866e96444 -j MASQUERADE
-A POSTROUTING -s 172.29.0.0/16 ! -o br-37cb60e72d96 -j MASQUERADE
-A POSTROUTING -s 172.22.0.0/16 ! -o br-47e4ff45cb98 -j MASQUERADE
-A POSTROUTING -s 172.19.0.0/16 ! -o br-ce1971446d95 -j MASQUERADE
-A POSTROUTING -s 172.18.0.0/16 ! -o br-87bd504a9fc4 -j MASQUERADE
-A POSTROUTING -s 172.21.0.2/32 -d 172.21.0.2/32 -p tcp -m tcp --dport 6060 -j MASQUERADE
-A POSTROUTING -s 172.21.0.3/32 -d 172.21.0.3/32 -p tcp -m tcp --dport 27017 -j MASQUERADE
-A POSTROUTING -s 172.21.0.4/32 -d 172.21.0.4/32 -p tcp -m tcp --dport 8081 -j MASQUERADE
-A POSTROUTING -s 172.18.0.4/32 -d 172.18.0.4/32 -p tcp -m tcp --dport 3080 -j MASQUERADE
-A POSTROUTING -s 172.18.0.4/32 -d 172.18.0.4/32 -p tcp -m tcp --dport 3009 -j MASQUERADE
-A POSTROUTING -s 172.18.0.5/32 -d 172.18.0.5/32 -p tcp -m tcp --dport 8080 -j MASQUERADE
-A DOCKER -i br-5b49c15166ad -j RETURN
-A DOCKER -i docker0 -j RETURN
-A DOCKER -i br-c796faca013a -j RETURN
-A DOCKER -i br-905866e96444 -j RETURN
-A DOCKER -i br-37cb60e72d96 -j RETURN
-A DOCKER ! -i br-c796faca013a -p tcp -m tcp --dport 6060 -j DNAT --to-destination 172.21.0.2:6060
-A DOCKER -d 127.0.0.1/32 ! -i br-c796faca013a -p tcp -m tcp --dport 27017 -j DNAT --to-destination 172.21.0.3:27017
-A DOCKER ! -i br-c796faca013a -p tcp -m tcp --dport 6081 -j DNAT --to-destination 172.21.0.4:8081
-A DOCKER ! -i br-5b49c15166ad -p tcp -m tcp --dport 3080 -j DNAT --to-destination 172.18.0.4:3080
-A DOCKER ! -i br-5b49c15166ad -p tcp -m tcp --dport 3009 -j DNAT --to-destination 172.18.0.4:3009
-A DOCKER ! -i br-5b49c15166ad -p tcp -m tcp --dport 8080 -j DNAT --to-destination 172.18.0.5:8080
COMMIT
# Completed on Tue Sep  8 21:42:23 2020





# Clear docker log
truncate -s 0 /var/lib/docker/containers/*/*-json.log

pure-pw useradd erp-soft -u nginx -g nginx -d /home/vanthienhung.vn/public_html/img_data/erp
vanthienhung_789

https://vanthienhung.vn/img_data/erp/A8C2B523-CA6B-4A88-A2A8-CC2AED34E601.jpg

# Import database into DB docker container
`docker exec -i docker_mariadb_1 sh -c 'exec mysql -uroot -p"$MYSQL_ROOT_PASSWORD"' < path/to/host/file.sql`

# Backup and restore database command
```shell
mysqldump -uroot -p "vanthienhun_d22a" | gzip > "vanthienhun_d22a".sql.gz
gzip < vanthienhun_d22a.sql.gz | mysql -uroot -ptcm851997 vanthienhung_20210406
zcat vanthienhun_d22a.sql.gz | mysql -uroot -p vanthienhung_20210406 --binary-mode
```

```
Debian/Ubuntu: iptables-save > /etc/iptables/rules.v4
RHEL/CentOS: iptables-save > /etc/sysconfig/iptables
These files can be loaded again with the command iptables-restore for IPv4.

Debian/Ubuntu: iptables-restore < /etc/iptables/rules.v4
RHEL/CentOS: iptables-restore < /etc/sysconfig/iptables
If you would also like to use IPv6 rules, these can be stored in a separate file.

Debian/Ubuntu: ip6tables-save > /etc/iptables/rules.v6
RHEL/CentOS: ip6tables-save > /etc/sysconfig/ip6tables

service iptables save
```

Sync data command
```
rsync --ignore-existing -trvhzP -e 'ssh -p 8282' img_data/ root@103.153.215.101:/home/cdnvantgBgj/cdn.vanthienhung.vn/public_html/img_data
```
